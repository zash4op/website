<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Exploration Game</title>
    <style>
        body, html { margin: 0; height: 100%; overflow: hidden; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, controls, player, terrain, clock;
        let mobileControlsEnabled = false;
        let isMobile = /Mobi|Android|iPhone|iPad/i.test(navigator.userAgent);
        let moveSpeed = 0.1;
        let rotationSpeed = 0.02;

        // Setup scene, camera, and renderer
        function init() {
            scene = new THREE.Scene();
            clock = new THREE.Clock();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Set camera position
            camera.position.set(0, 5, 15);
            
            // Lighting
            let ambientLight = new THREE.AmbientLight(0xFFFFFF, 0.5);
            scene.add(ambientLight);

            let directionalLight = new THREE.DirectionalLight(0xFFFFFF, 1);
            directionalLight.position.set(10, 10, 10);
            scene.add(directionalLight);

            // Add terrain
            createTerrain();
            
            // Add a player (a simple cube as the player)
            createPlayer();

            // Check for mobile controls
            if (isMobile) {
                mobileControlsEnabled = true;
                setupMobileControls();
            } else {
                // Use mouse for camera rotation on desktop
                window.addEventListener('keydown', onKeyDown);
            }

            // Handle resizing
            window.addEventListener('resize', onWindowResize);

            // Start animation loop
            animate();
        }

        // Create terrain (simple flat ground)
        function createTerrain() {
            const terrainGeometry = new THREE.PlaneGeometry(500, 500, 50, 50);
            const terrainMaterial = new THREE.MeshLambertMaterial({ color: 0x228B22, wireframe: false });
            terrain = new THREE.Mesh(terrainGeometry, terrainMaterial);
            terrain.rotation.x = -Math.PI / 2; // Make the terrain flat
            scene.add(terrain);
        }

        // Create player (cube representing the player)
        function createPlayer() {
            const geometry = new THREE.BoxGeometry(1, 2, 1);
            const material = new THREE.MeshBasicMaterial({ color: 0x0000ff });
            player = new THREE.Mesh(geometry, material);
            player.position.set(0, 1, 0);
            scene.add(player);
        }

        // Handle keydown event for desktop controls (WASD for movement)
        function onKeyDown(event) {
            switch (event.key) {
                case 'w':
                    player.position.z -= moveSpeed;
                    break;
                case 's':
                    player.position.z += moveSpeed;
                    break;
                case 'a':
                    player.position.x -= moveSpeed;
                    break;
                case 'd':
                    player.position.x += moveSpeed;
                    break;
                case ' ':
                    player.position.y += moveSpeed; // Jump
                    break;
            }
        }

        // Mobile controls setup (touch events)
        function setupMobileControls() {
            let touchStartX = 0, touchStartY = 0;
            let touchMoveX = 0, touchMoveY = 0;

            // Track touch start position
            document.body.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            });

            // Track touch move position
            document.body.addEventListener('touchmove', (e) => {
                touchMoveX = e.touches[0].clientX;
                touchMoveY = e.touches[0].clientY;

                let deltaX = touchMoveX - touchStartX;
                let deltaY = touchMoveY - touchStartY;

                if (Math.abs(deltaX) > Math.abs(deltaY)) {
                    player.position.x += deltaX * 0.01; // Horizontal movement
                } else {
                    player.position.z -= deltaY * 0.01; // Forward/Backward movement
                }

                touchStartX = touchMoveX;
                touchStartY = touchMoveY;
            });
        }

        // Resize window handler
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            // Camera rotation on desktop (using mouse movements)
            if (!isMobile) {
                const delta = clock.getDelta();
                if (player) {
                    camera.rotation.x += delta * rotationSpeed; // Camera rotation
                }
            }

            renderer.render(scene, camera);
        }

        // Initialize the game
        init();
    </script>
</body>
</html>
